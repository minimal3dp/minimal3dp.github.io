{{/* FAQ Schema Shortcode with Visual Display */}}
{{/* Usage: {{< faq >}}
   {{< faq-item question="Question here?" >}}Answer here{{< /faq-item >}}
   {{< /faq >}} 
*/}}

{{ if .Inner }}
<section class="faq-section" style="margin: 40px 0; padding: 30px; background: #F9FAFB; border-radius: 8px;">
  <h2 style="margin-top: 0; color: #1F2937;">Frequently Asked Questions</h2>
  <div class="faq-list">
    {{ .Inner | markdownify }}
  </div>
</section>

{{/* Generate FAQ Schema JSON-LD */}}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {{ $items := findRE "(?s)<div class=\"faq-item\"[^>]*data-question=\"([^\"]+)\"[^>]*data-answer=\"([^\"]+)\"" .Inner }}
    {{ $lastIndex := sub (len $items) 1 }}
    {{ range $index, $item := $items }}
      {{ $parts := findRE "data-question=\"([^\"]+)\"[^>]*data-answer=\"([^\"]+)\"" $item }}
      {{ if $parts }}
        {{ $question := index (findRE "data-question=\"([^\"]+)\"" $item) 0 | replaceRE "data-question=\"([^\"]+)\"" "$1" }}
        {{ $answer := index (findRE "data-answer=\"([^\"]+)\"" $item) 0 | replaceRE "data-answer=\"([^\"]+)\"" "$1" }}
        {
          "@type": "Question",
          "name": {{ $question | jsonify }},
          "acceptedAnswer": {
            "@type": "Answer",
            "text": {{ $answer | jsonify }}
          }
        }{{ if ne $index $lastIndex }},{{ end }}
      {{ end }}
    {{ end }}
  ]
}
</script>
{{ end }}
