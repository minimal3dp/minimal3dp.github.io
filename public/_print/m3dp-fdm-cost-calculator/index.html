<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="http://localhost:1313/m3dp-fdm-cost-calculator/">
<link rel="alternate" type="application/rss&#43;xml" href="http://localhost:1313/m3dp-fdm-cost-calculator/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>M3DP FDM 3D Print Cost Calculator | Minimal 3DP</title>
<meta name="description" content="M3DP FDM 3D Print Cost Calculator">
<meta property="og:url" content="http://localhost:1313/m3dp-fdm-cost-calculator/">
  <meta property="og:site_name" content="Minimal 3DP">
  <meta property="og:title" content="M3DP FDM 3D Print Cost Calculator">
  <meta property="og:description" content="M3DP FDM 3D Print Cost Calculator">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="M3DP FDM 3D Print Cost Calculator">
  <meta itemprop="description" content="M3DP FDM 3D Print Cost Calculator">
  <meta itemprop="wordCount" content="6">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="M3DP FDM 3D Print Cost Calculator">
  <meta name="twitter:description" content="M3DP FDM 3D Print Cost Calculator">
<link href="/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">Minimal 3DP</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/about/"><span>About</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/blog/"><span>Blog</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/projects/"><span>Projects</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/klipper-calibration/"><span>Klipper Calibration</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/m3dp-fdm-cost-calculator/"><span>M3DP FDM 3D Print Cost Calculator</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search">
  <div class="td-search__icon"></div>
  <input type="search" class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete="off">
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-default td-outer">
      <main role="main" class="td-main">
        <html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M3DP FDM 3D Print Cost Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Import Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            /* Light gray background */
        }
<pre><code>    /* Custom tooltip style */
    .info-icon {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        background-color: #9ca3af;
        /* gray-400 */
        color: white;
        border-radius: 50%;
        text-align: center;
        font-size: 0.75rem;
        line-height: 1rem;
        font-weight: bold;
        font-style: normal;
        cursor: help;
        margin-left: 4px;
        position: relative;
    }

    /* Tooltip text - hidden by default */
    .info-icon::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 125%;
        /* Position above the icon */
        left: 50%;
        transform: translateX(-50%);
        background-color: #1f2937;
        /* gray-800 */
        color: #fff;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 0.875rem;
        font-weight: 500;
        line-height: 1.25;
        white-space: normal;
        width: 320px;
        /* Fixed width for better readability */
        text-align: left;
        visibility: hidden;
        opacity: 0;
        transition: opacity 0.2s, visibility 0.2s;
        z-index: 10;
    }

    /* Show tooltip on hover */
    .info-icon:hover::after {
        visibility: visible;
        opacity: 1;
    }

    /* Custom style for the sticky summary box */
    .sticky-summary {
        position: sticky;
        top: 1.5rem;
        /* 24px */
        align-self: start;
        /* Prevents stretching to grid height */
    }

    /* Style for the material info boxes */
    .material-info {
        background-color: #f9fafb;
        /* gray-50 */
        border: 1px solid #e5e7eb;
        /* gray-200 */
        border-radius: 0.5rem;
        padding: 0.75rem;
        margin-top: 0.5rem;
        font-size: 0.875rem;
    }

    /* Pie Chart */
    #pie-chart {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        /* Conic gradient will be set by JS */
        background-image: conic-gradient(#3b82f6 0% 0%,
                /* Material (Blue) */
                #10b981 0% 0%,
                /* Labor (Green) */
                #f59e0b 0% 0%,
                /* Machine (Amber) */
                #ef4444 0% 0%,
                /* Tooling (Red) */
                #8b5cf6 0% 0%
                /* Finishing (Violet) */
            );
        border: 2px solid #e5e7eb;
    }

    /* Quote Modal */
    #quote-modal-backdrop {
        background-color: rgba(0, 0, 0, 0.5);
    }

    /* Print styles for Quote Modal */
    @media print {
        body * {
            visibility: hidden;
        }

        #quote-modal-content,
        #quote-modal-content * {
            visibility: visible;
        }

        #quote-modal-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            border: none !important;
            box-shadow: none !important;
            padding: 0 !important;
        }

        #quote-modal-header,
        #quote-modal-footer {
            display: none;
        }

        body {
            background-color: #ffffff;
        }
    }

    /* Collapsible reference sections */
    details summary {
        cursor: pointer;
        font-weight: 500;
        color: #1f2937;
        /* gray-800 */
        padding: 8px;
        background-color: #f9fafb;
        /* gray-50 */
        border-radius: 0.375rem;
        transition: background-color 0.2s;
    }

    details summary:hover {
        background-color: #f3f4f6;
        /* gray-100 */
    }

    details[open] summary {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
    }

    details&gt;div {
        padding: 1rem;
        border: 1px solid #e5e7eb;
        /* gray-200 */
        border-top: none;
        border-bottom-left-radius: 0.375rem;
        border-bottom-right-radius: 0.375rem;
    }
&lt;/style&gt;
</code></pre>
</head>
<body class="h-full bg-gray-100 p-4 sm:p-6 lg:p-8">
    <div class="container mx-auto max-w-7xl">
<pre><code>    &lt;!-- Header --&gt;
    &lt;header class=&quot;mb-6&quot;&gt;
        &lt;h1 class=&quot;text-3xl font-bold text-gray-900&quot;&gt;
            &lt;a href=&quot;https://minimal3dp.com&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;
                class=&quot;text-blue-600 hover:underline&quot;&gt;
                M3DP FDM 3D Print Cost Calculator
            &lt;/a&gt;
        &lt;/h1&gt;
        &lt;p class=&quot;mt-1 text-lg text-gray-600&quot;&gt;A comprehensive tool based on the Seregi &amp; Ficzere (2025) cost model,
            expanded for business and hobbyist quoting.&lt;/p&gt;
    &lt;/header&gt;

    &lt;!-- Main Content Grid --&gt;
    &lt;div class=&quot;grid grid-cols-1 lg:grid-cols-2 gap-6&quot;&gt;

        &lt;!-- Column 1: Input Forms --&gt;
        &lt;div class=&quot;flex flex-col gap-6&quot;&gt;

            &lt;!-- Save/Load Profile --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;div class=&quot;flex flex-col sm:flex-row gap-4&quot;&gt;
                    &lt;button id=&quot;save_profile&quot;
                        class=&quot;flex-1 bg-blue-600 text-white font-medium py-2 px-4 rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2&quot;&gt;
                        Save Printer Profile
                    &lt;/button&gt;
                    &lt;button id=&quot;load_profile&quot;
                        class=&quot;flex-1 bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded-lg shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2&quot;&gt;
                        Load Printer Profile
                    &lt;/button&gt;
                &lt;/div&gt;
                &lt;p class=&quot;text-xs text-gray-500 mt-3 text-center&quot;&gt;Saves/Loads all machine, tooling, power, and
                    markup settings. Job-specific parameters are not saved.&lt;/p&gt;
            &lt;/div&gt;

            &lt;!-- Card 1: Job Parameters --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;1. Job Parameters&lt;/h2&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-2 gap-4&quot;&gt;
                    &lt;!-- Quote Details --&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;quote_customer&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Customer Name (Optional)
                        &lt;/label&gt;
                        &lt;input type=&quot;text&quot; id=&quot;quote_customer&quot; placeholder=&quot;e.g., Jane Doe&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;quote_part_name&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Part/Project Name (Optional)
                        &lt;/label&gt;
                        &lt;input type=&quot;text&quot; id=&quot;quote_part_name&quot; placeholder=&quot;e.g., Enclosure V3&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;

                    &lt;div class=&quot;sm:col-span-2 border-t pt-4&quot;&gt;&lt;/div&gt;

                    &lt;!-- Print Job Details --&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;parts_per_program&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Parts Per Build Plate
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;The total number of identical parts printed on a single build plate.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;parts_per_program&quot; value=&quot;1&quot; min=&quot;1&quot; step=&quot;1&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;program_length_hr&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Total Print Time (Hours)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Total print job duration, in hours. From your slicer's estimate. (e.g., 4.5 for 4h 30m)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;program_length_hr&quot; value=&quot;1&quot; min=&quot;0&quot; step=&quot;0.1&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;model_material_g&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Model Material (grams)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Total mass of the main model material used, in grams. From your slicer.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;model_material_g&quot; value=&quot;10&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;support_material_g&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Support Material (grams)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Total mass of support material used, in grams. From your slicer. Enter 0 if no support is used.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;support_material_g&quot; value=&quot;0&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;failure_rate&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Est. Failure Rate (%)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Amortizes the cost of failed prints across successful ones. A 5% rate means you expect 1 in 20 prints to fail, increasing the cost.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;failure_rate&quot; value=&quot;5&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;!-- Card 2: Material &amp; Labor --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;2. Material &amp; Labor&lt;/h2&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-4&quot;&gt;
                    &lt;!-- Model Material --&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;model_material_cost_kg&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Model Material Cost ($/kg)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;The price you paid for a 1kg roll of your model filament. (e.g., 20)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;model_material_cost_kg&quot; value=&quot;20&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;model_material_type&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;Model
                            Material Type&lt;/label&gt;
                        &lt;select id=&quot;model_material_type&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                            &lt;optgroup label=&quot;Common&quot;&gt;
                                &lt;option value=&quot;1.24&quot;&gt;PLA (1.24 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.27&quot;&gt;PETG (1.27 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.04&quot;&gt;ABS (1.04 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.06&quot;&gt;ASA (1.06 g/cm³)&lt;/option&gt;
                            &lt;/optgroup&gt;
                            &lt;optgroup label=&quot;Engineering/Flexible&quot;&gt;
                                &lt;option value=&quot;1.20&quot;&gt;TPU/TPE (1.20 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.08&quot;&gt;Nylon (PA) (1.08 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.21&quot;&gt;Polycarbonate (PC) (1.20 g/cm³)&lt;/option&gt;
                            &lt;/optgroup&gt;
                            &lt;optgroup label=&quot;My Materials&quot; id=&quot;model_material_custom_group&quot;&gt;
                                &lt;!-- Custom materials added by JS --&gt;
                            &lt;/optgroup&gt;
                            &lt;optgroup label=&quot;Other&quot;&gt;
                                &lt;option value=&quot;custom&quot;&gt;Add New Custom...&lt;/option&gt;
                            &lt;/optgroup&gt;
                        &lt;/select&gt;
                    &lt;/div&gt;
                    &lt;div id=&quot;model_material_density_custom_wrapper&quot; class=&quot;hidden sm:col-span-2&quot;&gt;
                        &lt;label for=&quot;model_material_density_custom&quot;
                            class=&quot;block text-sm font-medium text-gray-700&quot;&gt;Custom Model Density (g/cm³)&lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;model_material_density_custom&quot; value=&quot;1.24&quot; min=&quot;0&quot; step=&quot;0.01&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;!-- Model Material Info Box --&gt;
                    &lt;div id=&quot;model_material_info&quot; class=&quot;material-info sm:col-span-2&quot;&gt;
                        &lt;!-- Content dynamically inserted by JS --&gt;
                    &lt;/div&gt;

                    &lt;!-- Support Material --&gt;
                    &lt;div class=&quot;sm:col-span-2 border-t pt-4&quot;&gt;&lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;support_material_cost_kg&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Support Material Cost ($/kg)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;The price you paid for a 1kg roll of your support filament.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;support_material_cost_kg&quot; value=&quot;20&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;support_material_type&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;Support
                            Material Type&lt;/label&gt;
                        &lt;select id=&quot;support_material_type&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                            &lt;optgroup label=&quot;Soluble&quot;&gt;
                                &lt;option value=&quot;1.25&quot;&gt;PVA (1.25 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.07&quot;&gt;HIPS (1.07 g/cm³)&lt;/option&gt;
                            &lt;/optgroup&gt;
                            &lt;optgroup label=&quot;Breakaway&quot;&gt;
                                &lt;option value=&quot;1.24&quot;&gt;PLA (1.24 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.27&quot;&gt;PETG (1.27 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.04&quot;&gt;ABS (1.04 g/cm³)&lt;/option&gt;
                                &lt;option value=&quot;1.06&quot;&gt;ASA (1.06 g/cm³)&lt;/option&gt;
                            &lt;/optgroup&gt;
                            &lt;optgroup label=&quot;My Materials&quot; id=&quot;support_material_custom_group&quot;&gt;
                                &lt;!-- Custom materials added by JS --&gt;
                            &lt;/optgroup&gt;
                            &lt;optgroup label=&quot;Other&quot;&gt;
                                &lt;option value=&quot;custom&quot;&gt;Add New Custom...&lt;/option&gt;
                            &lt;/optgroup&gt;
                        &lt;/select&gt;
                    &lt;/div&gt;
                    &lt;div id=&quot;support_material_density_custom_wrapper&quot; class=&quot;hidden sm:col-span-2&quot;&gt;
                        &lt;label for=&quot;support_material_density_custom&quot;
                            class=&quot;block text-sm font-medium text-gray-700&quot;&gt;Custom Support Density (g/cm³)&lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;support_material_density_custom&quot; value=&quot;1.24&quot; min=&quot;0&quot; step=&quot;0.01&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;!-- Support Material Info Box --&gt;
                    &lt;div id=&quot;support_material_info&quot; class=&quot;material-info sm:col-span-2&quot;&gt;
                        &lt;!-- Content dynamically inserted by JS --&gt;
                    &lt;/div&gt;

                    &lt;!-- Labor --&gt;
                    &lt;div class=&quot;sm:col-span-2 border-t pt-4&quot;&gt;&lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;hourly_wage&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Labor Rate ($/hour)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Your hourly rate for all manual labor (prep, post-processing, finishing).&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;hourly_wage&quot; value=&quot;20&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;prep_slicing_time&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Slicing &amp; Prep (min/build plate)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Time spent *per build plate* on file prep, model orientation, and slicer setup.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;prep_slicing_time&quot; value=&quot;10&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;manual_labor_time&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Machine Setup (min/build plate)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Time spent *per build plate* on printer setup, part removal, and cleanup. (Eq 6)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;manual_labor_time&quot; value=&quot;5&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;

                &lt;/div&gt;
            &lt;/div&gt;

            &lt;!-- Card 3: Custom Material Manager --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;3. My Material Library&lt;/h2&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-3 gap-4&quot;&gt;
                    &lt;div class=&quot;sm:col-span-1&quot;&gt;
                        &lt;label for=&quot;custom_material_name&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;Material
                            Name&lt;/label&gt;
                        &lt;input type=&quot;text&quot; id=&quot;custom_material_name&quot; placeholder=&quot;e.g., My CF-PC&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;sm:col-span-1&quot;&gt;
                        &lt;label for=&quot;custom_material_density&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;Density
                            (g/cm³)&lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;custom_material_density&quot; placeholder=&quot;e.g., 1.28&quot; min=&quot;0&quot;
                            step=&quot;0.01&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;sm:col-span-1 flex items-end&quot;&gt;
                        &lt;button id=&quot;save_custom_material&quot;
                            class=&quot;w-full bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2&quot;&gt;
                            Save Material
                        &lt;/button&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div id=&quot;custom_material_list&quot; class=&quot;mt-4 text-sm text-gray-600 space-y-1&quot;&gt;
                    &lt;!-- Saved materials will be listed here by JS --&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;!-- Card 4: Machine Operation --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;4. Machine Operation&lt;/h2&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-2 gap-4&quot;&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;printer_cost&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Printer Cost ($)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;The total purchase price of your 3D printer. (e.g., Hobbyist: $200-$1,000; Professional: $3,000-$10,000+). Used for depreciation.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;printer_cost&quot; value=&quot;1000&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;printer_lifespan_hr&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Printer Lifespan (hours)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Estimated total operational hours before the printer is fully depreciated (e.g., 20,000 hours).&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;printer_lifespan_hr&quot; value=&quot;20000&quot; min=&quot;1&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;maintenance_cost_hr&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Maintenance Cost ($/hour)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Cost of maintenance parts (belts, fans, etc.) amortized per hour. (e.g., $0.05 - $0.25). Hobbyist annual cost ($100-$200) / annual print hours.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;maintenance_cost_hr&quot; value=&quot;0.10&quot; min=&quot;0&quot; step=&quot;0.01&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;sm:col-span-2 border-t pt-4&quot;&gt;&lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;machine_power_w&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Avg. Power (Watts)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Average power consumption of the printer in Watts. (e.g., Ender 3: ~120-150W, Prusa MK3: ~100-130W).&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;machine_power_w&quot; value=&quot;130&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;electricity_cost_kwh&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Electricity Cost ($/kWh)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Your local electricity rate in dollars per kilowatt-hour. (e.g., $0.15)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;electricity_cost_kwh&quot; value=&quot;0.15&quot; min=&quot;0&quot; step=&quot;0.01&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;!-- Card 5: Tooling --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;5. Tooling (Eq 5)&lt;/h2&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-2 gap-4&quot;&gt;
                    &lt;!-- Build Plate --&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;build_plate_cost&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Build Plate Cost ($)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Cost of your PEI, Glass, or other build plate.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;build_plate_cost&quot; value=&quot;30&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;build_plate_lifespan_hr&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Build Plate Lifespan (hours)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Estimated total lifespan in print hours (e.g., PEI/Glass: 5000+).&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;build_plate_lifespan_hr&quot; value=&quot;5000&quot; min=&quot;1&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;

                    &lt;!-- Model Nozzle --&gt;
                    &lt;div class=&quot;sm:col-span-2 border-t pt-4&quot;&gt;&lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;model_nozzle_cost&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Model Nozzle Cost ($)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Cost of the nozzle for the model material. (e.g., Brass: $2, Hardened Steel: $15)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;model_nozzle_cost&quot; value=&quot;2&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;model_nozzle_lifespan_kg&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Model Nozzle Lifespan (kg)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Estimated filament mass (in kg) this nozzle can print. See guide below. (e.g., Brass/PLA: 25kg, Brass/CF: 0.5kg)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;model_nozzle_lifespan_kg&quot; value=&quot;25&quot; min=&quot;0.1&quot; step=&quot;0.1&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;

                    &lt;!-- Support Nozzle --&gt;
                    &lt;div class=&quot;sm:col-span-2 border-t pt-4&quot;&gt;&lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;support_nozzle_cost&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Support Nozzle Cost ($)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Cost of the nozzle for the support material. (If same as model, enter 0 and use model nozzle fields)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;support_nozzle_cost&quot; value=&quot;0&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;support_nozzle_lifespan_kg&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Support Nozzle Lifespan (kg)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Estimated filament mass (in kg) this nozzle can print. (Only if using a separate nozzle for support)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;support_nozzle_lifespan_kg&quot; value=&quot;25&quot; min=&quot;0.1&quot; step=&quot;0.1&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;!-- Card 6: Finishing &amp; Post-Processing (Optional) --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;6. Finishing &amp; Post-Processing
                    (Optional)&lt;/h2&gt;

                &lt;!-- Mechanical Finishing --&gt;
                &lt;h3 class=&quot;text-lg font-medium text-gray-700 mb-2&quot;&gt;Mechanical Finishing&lt;/h3&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4&quot;&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;finishing_labor_time_part&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Finishing Labor (min/part)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Time spent *per part* on sanding, painting, assembly, etc. Added to your total labor cost.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;finishing_labor_time_part&quot; value=&quot;0&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;finishing_materials_cost&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Finishing Materials ($/build plate)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Cost of non-filament materials *per build plate* (primer, paint, glue, screws).&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;finishing_materials_cost&quot; value=&quot;0&quot; min=&quot;0&quot; step=&quot;0.01&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;!-- Chemical Post-Processing --&gt;
                &lt;h3 class=&quot;text-lg font-medium text-gray-700 mb-2&quot;&gt;Chemical Post-Processing (Eq 2)&lt;/h3&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-2 gap-4&quot;&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;solvent_cost_liter&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Solvent Cost ($/Liter)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Cost per liter of your solvent (e.g., D-Limonene for HIPS, Water for PVA). 1 Liter = 1000 cm³&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;solvent_cost_liter&quot; value=&quot;0&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;solving_time_hr&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Solving Time (hours)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Time the part spends in the solvent bath.&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;solving_time_hr&quot; value=&quot;0&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;tank_power_w&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Tank Power (Watts)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;Average power consumption of the solvent tank (heater, stirrer).&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;tank_power_w&quot; value=&quot;0&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;!-- Card 7: Markup --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;7. Markup (Optional)&lt;/h2&gt;
                &lt;div class=&quot;grid grid-cols-1 sm:grid-cols-2 gap-4&quot;&gt;
                    &lt;div&gt;
                        &lt;label for=&quot;markup_percent&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;
                            Overhead &amp; Profit Markup (%)
                            &lt;span class=&quot;info-icon&quot;
                                data-tooltip=&quot;A percentage markup applied to the total cost per part for business overhead and profit. (e.g., 50)&quot;&gt;i&lt;/span&gt;
                        &lt;/label&gt;
                        &lt;input type=&quot;number&quot; id=&quot;markup_percent&quot; value=&quot;0&quot; min=&quot;0&quot;
                            class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm&quot;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;!-- Reference Guides (Collapsible) --&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-md p-6 space-y-4&quot;&gt;
                &lt;h2 class=&quot;text-xl font-semibold text-gray-800 border-b pb-3 mb-4&quot;&gt;Reference Guides&lt;/h2&gt;

                &lt;!-- Nozzle Lifespan Guide --&gt;
                &lt;details&gt;
                    &lt;summary class=&quot;text-lg&quot;&gt;Nozzle Lifespan Reference Guide&lt;/summary&gt;
                    &lt;div class=&quot;space-y-4&quot;&gt;
                        &lt;p class=&quot;text-sm text-gray-600&quot;&gt;Nozzle lifespan depends on the nozzle material and the
                            filament being printed. Abrasive filaments (carbon fiber, glow-in-the-dark, wood-fill)
                            will destroy brass nozzles very quickly.&lt;/p&gt;
                        &lt;div class=&quot;overflow-x-auto&quot;&gt;
                            &lt;table class=&quot;min-w-full divide-y divide-gray-200 text-sm&quot;&gt;
                                &lt;thead class=&quot;bg-gray-50&quot;&gt;
                                    &lt;tr&gt;
                                        &lt;th class=&quot;px-4 py-2 text-left font-medium text-gray-600&quot;&gt;Nozzle Material
                                        &lt;/th&gt;
                                        &lt;th class=&quot;px-4 py-2 text-left font-medium text-gray-600&quot;&gt;Filament Type&lt;/th&gt;
                                        &lt;th class=&quot;px-4 py-2 text-left font-medium text-gray-600&quot;&gt;Est. Lifespan (kg)
                                        &lt;/th&gt;
                                    &lt;/tr&gt;
                                &lt;/thead&gt;
                                &lt;tbody class=&quot;bg-white divide-y divide-gray-200&quot;&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;Brass&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;Standard (PLA, ABS, PETG)&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;10 - 25 kg+&lt;/td&gt;
                                    &lt;/tr&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;Brass&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2 text-red-600&quot;&gt;Abrasive (CF, Wood, Glow)&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2 text-red-600&quot;&gt;&amp;lt; 1 kg (as low as 0.25 kg)&lt;/td&gt;
                                    &lt;/tr&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;Stainless Steel&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;Standard &amp; Light Abrasive&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;20 - 50 kg+&lt;/td&gt;
                                    &lt;/tr&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;Hardened Steel&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;All, incl. Heavy Abrasive&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;50 - 100 kg+&lt;/td&gt;
                                    &lt;/tr&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;Ruby / Nozzle X&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;All, incl. Heavy Abrasive&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;100 kg++&lt;/td&gt;
                                    &lt;/tr&gt;
                                &lt;/tbody&gt;
                            &lt;/table&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/details&gt;

                &lt;!-- Nozzle Size Guide --&gt;
                &lt;details&gt;
                    &lt;summary class=&quot;text-lg&quot;&gt;Nozzle Size Reference Guide&lt;/summary&gt;
                    &lt;div class=&quot;space-y-4&quot;&gt;
                        &lt;p class=&quot;text-sm text-gray-600&quot;&gt;Nozzle diameter (size) is a trade-off between print speed
                            and detail.&lt;/p&gt;
                        &lt;div class=&quot;overflow-x-auto&quot;&gt;
                            &lt;table class=&quot;min-w-full divide-y divide-gray-200 text-sm&quot;&gt;
                                &lt;thead class=&quot;bg-gray-50&quot;&gt;
                                    &lt;tr&gt;
                                        &lt;th class=&quot;px-4 py-2 text-left font-medium text-gray-600&quot;&gt;Nozzle Size (mm)
                                        &lt;/th&gt;
                                        &lt;th class=&quot;px-4 py-2 text-left font-medium text-gray-600&quot;&gt;Typical Use Case
                                        &lt;/th&gt;
                                    &lt;/tr&gt;
                                &lt;/thead&gt;
                                &lt;tbody class=&quot;bg-white divide-y divide-gray-200&quot;&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;0.15 - 0.25&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;Extreme detail (e.g., miniatures), very slow. Prone to
                                            clogging.&lt;/td&gt;
                                    &lt;/tr&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;0.40 (Standard)&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;Best all-around balance of speed and detail. Default
                                            on most printers.&lt;/td&gt;
                                    &lt;/tr&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;0.60&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;Faster prints, stronger parts. Good for abrasive
                                            filaments. Loses fine detail.&lt;/td&gt;
                                    &lt;/tr&gt;
                                    &lt;tr&gt;
                                        &lt;td class=&quot;px-4 py-2 font-medium&quot;&gt;0.80 - 1.00+&lt;/td&gt;
                                        &lt;td class=&quot;px-4 py-2&quot;&gt;Very fast &quot;draft&quot; prints or large structural parts.
                                            Very low detail.&lt;/td&gt;
                                    &lt;/tr&gt;
                                &lt;/tbody&gt;
                            &lt;/table&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/details&gt;
            &lt;/div&gt;

            &lt;!-- Footer / References --&gt;
            &lt;footer class=&quot;mt-4 text-gray-600 text-xs&quot;&gt;
                &lt;h3 class=&quot;font-semibold text-gray-700 mb-2&quot;&gt;References&lt;/h3&gt;
                &lt;ul class=&quot;list-disc list-inside space-y-1&quot;&gt;
                    &lt;li&gt;
                        Seregi, B.L.; Ficzere, P. (2025). Refined Cost Calculation Framework for FDM Parts.
                        &lt;a href=&quot;https://www.mdpi.com/2504-4494/9/9/321&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;
                            class=&quot;text-blue-600 hover:underline&quot;&gt;
                            jmmp-09-00321
                        &lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li&gt;
                        Simplify3D (n.d.). Filament Properties Table.
                        &lt;a href=&quot;https://www.simplify3d.com/resources/materials-guide/properties-table/&quot;
                            target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot; class=&quot;text-blue-600 hover:underline&quot;&gt;
                            simplify3d.com
                        &lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li&gt;
                        Nozzle material &amp; lifespan guides (All3DP, Sovol, Creality, 3DJake, etc.)
                    &lt;/li&gt;
                    &lt;li&gt;
                        Build plate guides (All3DP, Bambu Lab Forum, Reddit, etc.)
                    &lt;/li&gt;
                    &lt;li&gt;
                        Fusion3 Design (n.d.). How Much Does a 3D Printer Cost?
                        &lt;a href=&quot;https://www.fusion3design.com/how-much-does-a-3d-printer-cost/&quot; target=&quot;_blank&quot;
                            rel=&quot;noopener noreferrer&quot; class=&quot;text-blue-600 hover:underline&quot;&gt;
                            fusion3design.com
                        &lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li&gt;
                        Machine maintenance guides (EufyMake, Raise3D, Qidi, etc.)
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/footer&gt;

        &lt;/div&gt; &lt;!-- End Column 1 --&gt;

        &lt;!-- Column 2: Cost Summary (Sticky) --&gt;
        &lt;div class=&quot;sticky-summary&quot;&gt;
            &lt;div class=&quot;bg-white rounded-lg shadow-lg p-6&quot;&gt;
                &lt;h2 class=&quot;text-2xl font-bold text-gray-900 border-b pb-3 mb-4&quot;&gt;Cost Summary&lt;/h2&gt;

                &lt;!-- Main Display Box --&gt;
                &lt;div class=&quot;bg-blue-600 text-white rounded-lg p-6 mb-4 text-center&quot;&gt;
                    &lt;label class=&quot;block text-sm font-medium text-blue-200&quot;&gt;Final Quoted Price (per Part)&lt;/label&gt;
                    &lt;div id=&quot;summary_final_quote&quot; class=&quot;text-5xl font-bold tracking-tight&quot;&gt;
                        $0.00
                    &lt;/div&gt;
                    &lt;div id=&quot;summary_total_cost_per_part&quot; class=&quot;text-sm text-blue-100 opacity-80 mt-1&quot;&gt;
                        ($0.00 base cost + $0.00 markup)
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;!-- Generate Quote Button --&gt;
                &lt;button id=&quot;generate_quote_btn&quot;
                    class=&quot;w-full bg-green-600 text-white font-medium py-2 px-4 rounded-lg shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 mb-4&quot;&gt;
                    Generate Printable Quote
                &lt;/button&gt;

                &lt;div class=&quot;bg-gray-50 rounded-lg p-4 mb-4&quot;&gt;
                    &lt;div class=&quot;flex justify-between items-center text-sm font-medium text-gray-600&quot;&gt;
                        &lt;span&gt;Total Build Plate Cost (for &lt;span id=&quot;summary_parts_count_1&quot;&gt;1&lt;/span&gt; part):&lt;/span&gt;
                        &lt;span id=&quot;summary_total_build_plate_cost&quot; class=&quot;text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;flex justify-between items-center text-sm font-medium text-gray-600 mt-1&quot;&gt;
                        &lt;span&gt;Base Cost (per Part):&lt;/span&gt;
                        &lt;span id=&quot;summary_base_cost_per_part&quot; class=&quot;text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;!-- Cost Breakdown --&gt;
                &lt;h3 class=&quot;text-lg font-semibold text-gray-800 mb-2&quot;&gt;Cost Breakdown (per Build Plate)&lt;/h3&gt;

                &lt;!-- Pie Chart &amp; Legend --&gt;
                &lt;div class=&quot;flex flex-col sm:flex-row items-center gap-4 mb-4&quot;&gt;
                    &lt;div id=&quot;pie-chart&quot; class=&quot;flex-shrink-0&quot;&gt;&lt;/div&gt;
                    &lt;div id=&quot;pie-legend&quot; class=&quot;text-sm space-y-1 w-full&quot;&gt;
                        &lt;!-- Legend items inserted by JS --&gt;
                        &lt;div class=&quot;flex items-center justify-between&quot;&gt;
                            &lt;div&gt;&lt;span class=&quot;inline-block w-3 h-3 rounded-full mr-2&quot;
                                    style=&quot;background-color: #3b82f6;&quot;&gt;&lt;/span&gt;Material&lt;/div&gt;
                            &lt;div id=&quot;legend_material&quot; class=&quot;font-medium&quot;&gt;$0.00 (0%)&lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;flex items-center justify-between&quot;&gt;
                            &lt;div&gt;&lt;span class=&quot;inline-block w-3 h-3 rounded-full mr-2&quot;
                                    style=&quot;background-color: #10b981;&quot;&gt;&lt;/span&gt;Labor&lt;/div&gt;
                            &lt;div id=&quot;legend_labor&quot; class=&quot;font-medium&quot;&gt;$0.00 (0%)&lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;flex items-center justify-between&quot;&gt;
                            &lt;div&gt;&lt;span class=&quot;inline-block w-3 h-3 rounded-full mr-2&quot;
                                    style=&quot;background-color: #f59e0b;&quot;&gt;&lt;/span&gt;Machine&lt;/div&gt;
                            &lt;div id=&quot;legend_machine&quot; class=&quot;font-medium&quot;&gt;$0.00 (0%)&lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;flex items-center justify-between&quot;&gt;
                            &lt;div&gt;&lt;span class=&quot;inline-block w-3 h-3 rounded-full mr-2&quot;
                                    style=&quot;background-color: #ef4444;&quot;&gt;&lt;/span&gt;Tooling&lt;/div&gt;
                            &lt;div id=&quot;legend_tooling&quot; class=&quot;font-medium&quot;&gt;$0.00 (0%)&lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;flex items-center justify-between&quot;&gt;
                            &lt;div&gt;&lt;span class=&quot;inline-block w-3 h-3 rounded-full mr-2&quot;
                                    style=&quot;background-color: #8b5cf6;&quot;&gt;&lt;/span&gt;Finishing&lt;/div&gt;
                            &lt;div id=&quot;legend_finishing&quot; class=&quot;font-medium&quot;&gt;$0.00 (0%)&lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;div class=&quot;space-y-2 text-sm&quot;&gt;
                    &lt;!-- Material --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;1. Material Cost&lt;/span&gt;
                        &lt;span id=&quot;summary_material_cost&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;!-- Labor --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;2. Labor Cost&lt;/span&gt;
                        &lt;span id=&quot;summary_labor_cost&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;!-- Machine --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;3. Machine Operation&lt;/span&gt;
                        &lt;span id=&quot;summary_machine_cost&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;!-- Tooling --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;4. Tooling&lt;/span&gt;
                        &lt;span id=&quot;summary_tooling_cost&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;!-- Finishing --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;5. Finishing &amp; Post-Processing&lt;/span&gt;
                        &lt;span id=&quot;summary_post_processing_cost&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;border-t my-2&quot;&gt;&lt;/div&gt;
                    &lt;!-- Subtotal --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;font-semibold text-gray-800&quot;&gt;Subtotal (Base Cost)&lt;/span&gt;
                        &lt;span id=&quot;summary_subtotal_cost&quot; class=&quot;font-bold text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;!-- Failure Rate --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;Failure Rate Markup (&lt;span
                                id=&quot;summary_failure_rate&quot;&gt;5&lt;/span&gt;%)&lt;/span&gt;
                        &lt;span id=&quot;summary_failure_cost&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;!-- Total --&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;font-semibold text-gray-800&quot;&gt;Total Build Plate Cost&lt;/span&gt;
                        &lt;span id=&quot;summary_total_cost&quot; class=&quot;font-bold text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;!-- Quick Metrics --&gt;
                &lt;h3 class=&quot;text-lg font-semibold text-gray-800 mt-6 mb-2&quot;&gt;Quick Metrics&lt;/h3&gt;
                &lt;div class=&quot;space-y-2 text-sm&quot;&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;Total Print Time&lt;/span&gt;
                        &lt;span id=&quot;summary_total_time&quot; class=&quot;font-medium text-gray-900&quot;&gt;1.00 hr&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;Total Mass&lt;/span&gt;
                        &lt;span id=&quot;summary_total_mass&quot; class=&quot;font-medium text-gray-900&quot;&gt;10 g&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;border-t my-2&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;Cost per Print Hour&lt;/span&gt;
                        &lt;span id=&quot;summary_cost_per_hour&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;flex justify-between&quot;&gt;
                        &lt;span class=&quot;text-gray-600&quot;&gt;Cost per Gram&lt;/span&gt;
                        &lt;span id=&quot;summary_cost_per_gram&quot; class=&quot;font-medium text-gray-900&quot;&gt;$0.00&lt;/span&gt;
                    &lt;/div&gt;
                &lt;/div&gt;

                &lt;!-- Message Box --&gt;
                &lt;div id=&quot;message_box&quot; class=&quot;hidden mt-4 p-3 rounded-md text-sm&quot;&gt;
                    &lt;!-- Messages inserted here --&gt;
                &lt;/div&gt;

            &lt;/div&gt;
        &lt;/div&gt; &lt;!-- End Column 2 --&gt;
    &lt;/div&gt; &lt;!-- End Main Grid --&gt;
&lt;/div&gt; &lt;!-- End Container --&gt;

&lt;!-- Quote Modal --&gt;
&lt;div id=&quot;quote-modal&quot; class=&quot;fixed inset-0 z-50 flex items-center justify-center p-4 hidden&quot;&gt;
    &lt;!-- Backdrop --&gt;
    &lt;div id=&quot;quote-modal-backdrop&quot; class=&quot;fixed inset-0&quot;&gt;&lt;/div&gt;

    &lt;!-- Modal Content --&gt;
    &lt;div id=&quot;quote-modal-content&quot;
        class=&quot;bg-white rounded-lg shadow-2xl z-10 w-full max-w-2xl border border-gray-300&quot;&gt;
        &lt;div id=&quot;quote-modal-header&quot; class=&quot;flex justify-between items-center p-4 border-b&quot;&gt;
            &lt;h2 class=&quot;text-xl font-semibold text-gray-800&quot;&gt;Print Job Quote&lt;/h2&gt;
            &lt;button id=&quot;quote-modal-close&quot; class=&quot;text-gray-400 hover:text-gray-600&quot;&gt;
                &lt;svg class=&quot;w-6 h-6&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot;
                    xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
                    &lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; stroke-width=&quot;2&quot; d=&quot;M6 18L18 6M6 6l12 12&quot;&gt;
                    &lt;/path&gt;
                &lt;/svg&gt;
            &lt;/button&gt;
        &lt;/div&gt;

        &lt;div class=&quot;p-8&quot;&gt;
            &lt;div class=&quot;flex justify-between items-start mb-6&quot;&gt;
                &lt;div&gt;
                    &lt;h3 class=&quot;text-2xl font-bold text-gray-900&quot;&gt;Quote&lt;/h3&gt;
                    &lt;p class=&quot;text-sm text-gray-500&quot;&gt;Generated: &lt;span id=&quot;quote_date&quot;&gt;--&lt;/span&gt;&lt;/p&gt;
                &lt;/div&gt;
                &lt;div class=&quot;text-right&quot;&gt;
                    &lt;h4 class=&quot;text-lg font-semibold text-gray-700&quot;&gt;From:&lt;/h4&gt;
                    &lt;p class=&quot;text-gray-600&quot;&gt;My 3D Printing Service&lt;/p&gt;
                    &lt;!-- You can add more 'From' details here --&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class=&quot;bg-gray-50 rounded-lg p-4 mb-6&quot;&gt;
                &lt;h4 class=&quot;text-lg font-semibold text-gray-700 mb-2&quot;&gt;To:&lt;/h4&gt;
                &lt;p id=&quot;quote_customer_name&quot; class=&quot;text-gray-600&quot;&gt;N/A&lt;/p&gt;
            &lt;/div&gt;

            &lt;h4 class=&quot;text-lg font-semibold text-gray-700 mb-2&quot;&gt;Project Details:&lt;/h4&gt;
            &lt;div class=&quot;overflow-x-auto border rounded-lg&quot;&gt;
                &lt;table class=&quot;min-w-full divide-y divide-gray-200&quot;&gt;
                    &lt;tbody class=&quot;bg-white divide-y divide-gray-200&quot;&gt;
                        &lt;tr&gt;
                            &lt;td class=&quot;px-6 py-3 text-sm font-medium text-gray-500 whitespace-nowrap&quot;&gt;Part/Project
                                Name&lt;/td&gt;
                            &lt;td id=&quot;quote_part_name_val&quot; class=&quot;px-6 py-3 text-sm text-gray-900 font-medium&quot;&gt;--&lt;/td&gt;
                        &lt;/tr&gt;
                        &lt;tr&gt;
                            &lt;td class=&quot;px-6 py-3 text-sm font-medium text-gray-500 whitespace-nowrap&quot;&gt;Model Material
                            &lt;/td&gt;
                            &lt;td id=&quot;quote_material_val&quot; class=&quot;px-6 py-3 text-sm text-gray-900&quot;&gt;--&lt;/td&gt;
                        &lt;/tr&gt;
                        &lt;tr&gt;
                            &lt;td class=&quot;px-6 py-3 text-sm font-medium text-gray-500 whitespace-nowrap&quot;&gt;Est. Print
                                Time&lt;/td&gt;
                            &lt;td id=&quot;quote_time_val&quot; class=&quot;px-6 py-3 text-sm text-gray-900&quot;&gt;--&lt;/td&gt;
                        &lt;/tr&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;
            &lt;/div&gt;

            &lt;h4 class=&quot;text-lg font-semibold text-gray-700 mt-6 mb-2&quot;&gt;Pricing:&lt;/h4&gt;
            &lt;div class=&quot;overflow-x-auto border rounded-lg&quot;&gt;
                &lt;table class=&quot;min-w-full divide-y divide-gray-200&quot;&gt;
                    &lt;thead class=&quot;bg-gray-50&quot;&gt;
                        &lt;tr&gt;
                            &lt;th
                                class=&quot;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;
                                Item&lt;/th&gt;
                            &lt;th
                                class=&quot;px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;
                                Quantity&lt;/th&gt;
                            &lt;th
                                class=&quot;px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;
                                Price per Part&lt;/th&gt;
                            &lt;th
                                class=&quot;px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;
                                Total&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                    &lt;tbody class=&quot;bg-white divide-y divide-gray-200&quot;&gt;
                        &lt;tr&gt;
                            &lt;td id=&quot;quote_item_name&quot; class=&quot;px-6 py-4 text-sm font-medium text-gray-900&quot;&gt;--&lt;/td&gt;
                            &lt;td id=&quot;quote_quantity_val&quot; class=&quot;px-6 py-4 text-sm text-gray-700 text-right&quot;&gt;--&lt;/td&gt;
                            &lt;td id=&quot;quote_price_per_val&quot; class=&quot;px-6 py-4 text-sm text-gray-700 text-right&quot;&gt;--&lt;/td&gt;
                            &lt;td id=&quot;quote_total_val&quot; class=&quot;px-6 py-4 text-sm font-medium text-gray-900 text-right&quot;&gt;
                                --&lt;/td&gt;
                        &lt;/tr&gt;
                    &lt;/tbody&gt;
                    &lt;tfoot class=&quot;bg-gray-50&quot;&gt;
                        &lt;tr&gt;
                            &lt;td colspan=&quot;3&quot; class=&quot;px-6 py-3 text-right text-sm font-bold text-gray-800 uppercase&quot;&gt;
                                Grand Total&lt;/td&gt;
                            &lt;td id=&quot;quote_grand_total_val&quot;
                                class=&quot;px-6 py-3 text-right text-sm font-bold text-gray-900&quot;&gt;--&lt;/td&gt;
                        &lt;/tr&gt;
                    &lt;/tfoot&gt;
                &lt;/table&gt;
            &lt;/div&gt;

            &lt;div class=&quot;mt-6&quot;&gt;
                &lt;h4 class=&quot;text-lg font-semibold text-gray-700 mb-2&quot;&gt;Notes:&lt;/h4&gt;
                &lt;textarea id=&quot;quote_notes_input&quot;
                    class=&quot;w-full h-24 p-2 border rounded-md text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500&quot;
                    placeholder=&quot;e.g., Estimated lead time: 3-5 business days. Price valid for 30 days.&quot;&gt;&lt;/textarea&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;div id=&quot;quote-modal-footer&quot; class=&quot;flex justify-end items-center p-4 bg-gray-50 border-t rounded-b-lg&quot;&gt;
            &lt;button id=&quot;quote-modal-print&quot;
                class=&quot;bg-blue-600 text-white font-medium py-2 px-4 rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2&quot;&gt;
                Print Quote
            &lt;/button&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;


&lt;script&gt;
    document.addEventListener('DOMContentLoaded', () =&gt; {
        // --- DATA &amp; CONSTANTS ---

        // Data from Simplify3D Properties Table
        const materialProperties = {
            '1.24': { // PLA
                name: 'PLA',
                density: 1.24,
                extruderTemp: '190-230 °C',
                bedTemp: '20-60 °C',
                surface: 'Blue painter\'s tape, glue stick, PEI sheet'
            },
            '1.27': { // PETG
                name: 'PETG',
                density: 1.27,
                extruderTemp: '220-250 °C',
                bedTemp: '50-75 °C',
                surface: 'Blue painter\'s tape, PEI sheet (w/ glue stick as release agent)'
            },
            '1.04': { // ABS
                name: 'ABS',
                density: 1.04,
                extruderTemp: '210-250 °C',
                bedTemp: '80-110 °C',
                surface: 'Kapton tape, ABS slurry, PEI sheet'
            },
            '1.06': { // ASA
                name: 'ASA',
                density: 1.06,
                extruderTemp: '240-260 °C',
                bedTemp: '90-110 °C',
                surface: 'Kapton tape, PEI sheet'
            },
            '1.20': { // TPU/TPE
                name: 'TPU/TPE',
                density: 1.20,
                extruderTemp: '210-230 °C',
                bedTemp: '20-60 °C',
                surface: 'Blue painter\'s tape, glue stick'
            },
            '1.08': { // Nylon (PA)
                name: 'Nylon (PA)',
                density: 1.08,
                extruderTemp: '240-260 °C',
                bedTemp: '70-90 °C',
                surface: 'Garolite sheet, glue stick on glass'
            },
            '1.21': { // Polycarbonate (PC)
                name: 'Polycarbonate (PC)',
                density: 1.20,
                extruderTemp: '270-310 °C',
                bedTemp: '90-110 °C',
                surface: 'Garolite sheet, PEI sheet with glue stick'
            },
            'custom': {
                name: 'Custom',
                density: null, // Will be user-defined
                extruderTemp: 'N/A',
                bedTemp: 'N/A',
                surface: 'Refer to manufacturer'
            },
            // Support-specific materials
            '1.25': { // PVA
                name: 'PVA',
                density: 1.25,
                extruderTemp: '190-220 °C',
                bedTemp: '20-60 °C',
                surface: 'Blue painter\'s tape, PEI sheet (dissolves in water)'
            },
            '1.07': { // HIPS
                name: 'HIPS',
                density: 1.07,
                extruderTemp: '220-240 °C',
                bedTemp: '90-110 °C',
                surface: 'Kapton tape, PEI (dissolves in D-Limonene)'
            }
        };


        // --- DOM Elements ---
        const allInputs = document.querySelectorAll('input, select');
        const messageBox = document.getElementById('message_box');
        const saveProfileButton = document.getElementById('save_profile');
        const loadProfileButton = document.getElementById('load_profile');
        const saveMaterialButton = document.getElementById('save_custom_material');
        const pieChartEl = document.getElementById('pie-chart');

        // Quote Modal Elements
        const quoteModal = document.getElementById('quote-modal');
        const quoteModalCloseBtn = document.getElementById('quote-modal-close');
        const quoteModalBackdrop = document.getElementById('quote-modal-backdrop');
        const generateQuoteBtn = document.getElementById('generate_quote_btn');
        const printQuoteBtn = document.getElementById('quote-modal-print');

        // --- Storage Availability Check ---
        let storageAvailable = false;
        try {
            const testKey = 'fdm_calc_storage_test';
            localStorage.setItem(testKey, 'test');
            localStorage.removeItem(testKey);
            storageAvailable = true;
        } catch (e) {
            storageAvailable = false;
            console.warn(&quot;LocalStorage is not available. Profile/Material saving will be disabled.&quot;);
            // Disable buttons and show a persistent error
            if (saveProfileButton) saveProfileButton.disabled = true;
            if (loadProfileButton) loadProfileButton.disabled = true;
            if (saveMaterialButton) saveMaterialButton.disabled = true;
            if (saveProfileButton) saveProfileButton.classList.add('opacity-50', 'cursor-not-allowed');
            if (loadProfileButton) loadProfileButton.classList.add('opacity-50', 'cursor-not-allowed');
            if (saveMaterialButton) saveMaterialButton.classList.add('opacity-50', 'cursor-not-allowed');

            // Show a message in the *main* message box
            if (messageBox) {
                messageBox.textContent = 'Profile &amp; Material saving is disabled: Browser storage is not available or blocked.';
                messageBox.className = 'mt-4 p-3 rounded-md text-sm bg-yellow-100 text-yellow-800';
                messageBox.classList.remove('hidden');
            }
        }

        const CUSTOM_MATERIALS_KEY = 'fdmCustomMaterials';
        let lastCalculatedCosts = {}; // Store results for the quote modal

        // --- HELPER FUNCTIONS ---

        /**
         * Gets the numeric value from an input field.
         * @param {string} id - The ID of the input element.
         * @returns {number} The parsed float value, or 0 if invalid.
         */
        function getVal(id) {
            const el = document.getElementById(id);
            if (!el) {
                console.warn(`Element with ID ${id} not found.`);
                return 0;
            }
            const val = parseFloat(el.value);
            return isNaN(val) ? 0 : val;
        }

        /**
         * Gets the string value from an input field.
         * @param {string} id - The ID of the input element.
         * @returns {string} The value.
         */
        function getStr(id) {
            const el = document.getElementById(id);
            return el ? el.value : '';
        }

        /**
         * Formats a number as a currency string.
         * @param {number} num - The number to format.
         * @returns {string} The formatted currency string (e.g., &quot;$1.23&quot;).
         */
        function formatCurrency(num) {
            if (isNaN(num)) return &quot;$0.00&quot;;
            return num.toLocaleString('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        /**
         * Formats a number to a fixed number of decimal places.
         * @param {number} num - The number to format.
         * @param {number} places - The number of decimal places.
         * @returns {string} The formatted number string.
         */
        function formatNum(num, places = 2) {
            if (isNaN(num)) return (0).toFixed(places);
            return num.toFixed(places);
        }

        /**
         * Displays a message to the user.
         * @param {string} text - The message text.
         * @param {'success' | 'error' | 'warn'} type - The message type.
         */
        function showMessage(text, type = 'success') {
            if (!messageBox) return; // Guard clause
            messageBox.textContent = text;
            if (type === 'success') {
                messageBox.className = 'mt-4 p-3 rounded-md text-sm bg-green-100 text-green-800';
            } else if (type === 'error') {
                messageBox.className = 'mt-4 p-3 rounded-md text-sm bg-red-100 text-red-800';
            } else { // 'warn'
                messageBox.className = 'mt-4 p-3 rounded-md text-sm bg-yellow-100 text-yellow-800';
            }
            messageBox.classList.remove('hidden');

            // Hide message after 3 seconds, unless it's the storage warning
            if (text.includes('Browser storage')) return;

            setTimeout(() =&gt; {
                messageBox.classList.add('hidden');
            }, 3000);
        }

        /**
         * Toggles the visibility of the custom density input.
         * @param {string} selectId - The ID of the material &lt;select&gt; element.
         * @param {string} wrapperId - The ID of the custom density wrapper &lt;div&gt;.
         */
        function toggleCustomDensity(selectId, wrapperId) {
            const select = document.getElementById(selectId);
            const wrapper = document.getElementById(wrapperId);
            if (!select || !wrapper) return;
            if (select.value === 'custom') {
                wrapper.classList.remove('hidden');
            } else {
                wrapper.classList.add('hidden');
            }
        }

        /**
         * Gets the density for a selected material.
         * @param {string} typeSelectId - The ID of the material type dropdown.
         * @param {string} customInputId - The ID of the custom density input.
         * @returns {number} The density in g/cm³.
         */
        function getDensity(typeSelectId, customInputId) {
            const typeVal = getStr(typeSelectId);
            if (typeVal === 'custom') {
                return getVal(customInputId);
            }

            // Check standard properties
            if (materialProperties[typeVal]) {
                return materialProperties[typeVal].density;
            }

            // Check custom materials (value will be density_name)
            if (typeVal.includes('_')) {
                return parseFloat(typeVal.split('_')[0]);
            }

            return 1.24; // Default to PLA density if not found
        }

        /**
         * Gets the name for a selected material.
         * @param {string} typeSelectId - The ID of the material type dropdown.
         * @returns {string} The material name.
         */
        function getMaterialName(typeSelectId) {
            const select = document.getElementById(typeSelectId);
            if (!select) return &quot;N/A&quot;;

            const typeVal = select.value;

            // Check standard properties
            if (materialProperties[typeVal]) {
                return materialProperties[typeVal].name;
            }

            // Check custom materials (value will be density_name)
            if (typeVal.includes('_')) {
                return typeVal.split('_')[1];
            }

            return &quot;N/A&quot;;
        }

        /**
         * Updates the material info box.
         * @param {string} selectId - The ID of the material &lt;select&gt; element.
         * @param {string} infoBoxId - The ID of the info box &lt;div&gt;.
         */
        function updateMaterialInfo(selectId, infoBoxId) {
            const select = document.getElementById(selectId);
            const infoBox = document.getElementById(infoBoxId);
            if (!select || !infoBox) return;
            const key = select.value;

            if (key === 'custom') {
                infoBox.innerHTML = `&lt;p class=&quot;text-gray-700&quot;&gt;Please add a new custom material from the &quot;My Material Library&quot; card below, or temporarily enter a density if this is a one-time use.&lt;/p&gt;`;
                return;
            }

            let props;
            if (materialProperties[key]) {
                props = materialProperties[key];
            } else if (key.includes('_')) {
                // Custom material
                const parts = key.split('_');
                props = {
                    name: parts[1],
                    density: parseFloat(parts[0]),
                    extruderTemp: 'N/A',
                    bedTemp: 'N/A',
                    surface: 'Refer to manufacturer'
                };
            } else {
                infoBox.innerHTML = '';
                return;
            }

            infoBox.innerHTML = `
                &lt;strong class=&quot;text-gray-900&quot;&gt;${props.name} Properties:&lt;/strong&gt;
                &lt;ul class=&quot;list-disc list-inside ml-1 text-gray-700 space-y-1 mt-1&quot;&gt;
                    &lt;li&gt;&lt;strong&gt;Density:&lt;/strong&gt; ${props.density} g/cm³&lt;/li&gt;
                    &lt;li&gt;&lt;strong&gt;Extruder Temp:&lt;/strong&gt; ${props.extruderTemp}&lt;/li&gt;
                    &lt;li&gt;&lt;strong&gt;Bed Temp:&lt;/strong&gt; ${props.bedTemp}&lt;/li&gt;
                    &lt;li&gt;&lt;strong&gt;Build Surface:&lt;/strong&gt; ${props.surface}&lt;/li&gt;
                &lt;/ul&gt;
            `;
        }


        // --- MAIN CALCULATION ---

        function calculateCost() {
            // --- 1. Get All Input Values ---

            // Job Parameters
            const N_parts = getVal('parts_per_program');
            const t_program = getVal('program_length_hr'); // hours
            const m_model_g = getVal('model_material_g'); // grams
            const m_support_g = getVal('support_material_g'); // grams
            const failure_rate = getVal('failure_rate') / 100; // as decimal

            // Material &amp; Labor
            const p_model_kg = getVal('model_material_cost_kg'); // $/kg
            const p_support_kg = getVal('support_material_cost_kg'); // $/kg
            const p_hourlywage = getVal('hourly_wage'); // $/hour
            const t_prep_min = getVal('prep_slicing_time'); // minutes/build plate
            const t_manual_min = getVal('manual_labor_time'); // minutes/build plate

            // Densities
            const d_model = getDensity('model_material_type', 'model_material_density_custom'); // g/cm³
            const d_support = getDensity('support_material_type', 'support_material_density_custom'); // g/cm³

            // Machine Operation
            const p_printer = getVal('printer_cost');
            const t_printer_lifespan = getVal('printer_lifespan_hr');
            const p_maintenance_hr = getVal('maintenance_cost_hr');
            const E_machine_w = getVal('machine_power_w'); // watts
            const p_electricity_kwh = getVal('electricity_cost_kwh'); // $/kWh

            // Tooling
            const p_bed = getVal('build_plate_cost');
            const t_bed_lifespan = getVal('build_plate_lifespan_hr');
            const p_model_tip = getVal('model_nozzle_cost');
            const m_model_tip_lifespan_kg = getVal('model_nozzle_lifespan_kg'); // kg
            const p_support_tip = getVal('support_nozzle_cost');
            const m_support_tip_lifespan_kg = getVal('support_nozzle_lifespan_kg'); // kg

            // Finishing &amp; Post-Processing
            const t_finishing_min_part = getVal('finishing_labor_time_part'); // minutes/part
            const p_finishing_materials = getVal('finishing_materials_cost'); // $/build plate
            const p_solvent_liter = getVal('solvent_cost_liter'); // $/Liter
            const t_solving_hr = getVal('solving_time_hr'); // hours
            const E_tank_w = getVal('tank_power_w'); // watts

            // Markup
            const markup_percent = getVal('markup_percent') / 100; // as decimal

            // --- 2. Perform Calculations (based on article) ---

            // --- Helper Calcs: Volumes (V) ---
            // Volume = Mass / Density. V_model and V_support in cm³
            const V_model_total = (d_model &gt; 0) ? (m_model_g / d_model) : 0;
            const V_support_total = (d_support &gt; 0) ? (m_support_g / d_support) : 0;

            // --- Helper Calcs: Lifespan Conversions ---
            // Convert Nozzle Lifespan from mass (kg) to volume (cm³)
            // Lifetime_Volume = (Lifetime_Mass_g / Density)
            const V_m_lifespan = (d_model &gt; 0) ? ((m_model_tip_lifespan_kg * 1000) / d_model) : 0;
            const V_s_lifespan = (d_support &gt; 0) ? ((m_support_tip_lifespan_kg * 1000) / d_support) : 0;


            // --- Cost Component 1: Material (C_material) (Eq 1, modified) ---
            // We use mass (g) and price per kg ($/kg)
            const C_model = (m_model_g / 1000) * p_model_kg;
            const C_support = (m_support_g / 1000) * p_support_kg;
            const C_material_build_plate = C_model + C_support;

            // --- Cost Component 2: Labor (C_labor) (Eq 6, v2) ---
            const t_build_plate_labor_min = t_prep_min + t_manual_min;
            const t_part_labor_min = t_finishing_min_part * N_parts;
            const t_total_labor_hr = (t_build_plate_labor_min + t_part_labor_min) / 60;
            const C_labor_build_plate = p_hourlywage * t_total_labor_hr;

            // --- Cost Component 3: Machine Operation (C_machine) (Eq 3 &amp; 4, expanded) ---
            // C_depreciation ($/hr) = Printer Cost / Printer Lifespan
            const C_depreciation_hr = (t_printer_lifespan &gt; 0) ? (p_printer / t_printer_lifespan) : 0;
            // C_power ($/hr) = (Watts / 1000) * $/kWh
            const C_power_hr = (E_machine_w / 1000) * p_electricity_kwh;
            // C_machine_hr = Depreciation + Maintenance + Power
            const C_machine_hr = C_depreciation_hr + p_maintenance_hr + C_power_hr;
            const C_machine_build_plate = C_machine_hr * t_program;

            // --- Cost Component 4: Tooling (C_tooling) (Eq 5, modified) ---
            // C_bed = (Bed Cost / Bed Lifespan_hr) * Program_hr
            const C_bed = (t_bed_lifespan &gt; 0) ? (p_bed / t_bed_lifespan) * t_program : 0;
            // C_nozzle = (Nozzle Cost / Nozzle Lifespan_cm³) * Volume_cm³
            const C_model_tip = (V_m_lifespan &gt; 0) ? (p_model_tip / V_m_lifespan) * V_model_total : 0;
            // Check if separate support nozzle is used
            const C_support_tip = (p_support_tip &gt; 0 &amp;&amp; V_s_lifespan &gt; 0) ?
                (p_support_tip / V_s_lifespan) * V_support_total : 0;
            // If no separate support nozzle, add support volume to model nozzle wear
            const C_model_tip_extra_wear = (p_support_tip &lt;= 0 &amp;&amp; V_m_lifespan &gt; 0) ?
                (p_model_tip / V_m_lifespan) * V_support_total : 0;

            const C_tooling_build_plate = C_bed + C_model_tip + C_support_tip + C_model_tip_extra_wear;

            // --- Cost Component 5: Post-Processing (C_postprocess) (Eq 2) ---
            // C_solvent = (p_solvent_liter / 1000 cm³) * V_support_cm³
            const C_solvent = (p_solvent_liter / 1000) * V_support_total;
            // C_tank_power = (Tank_Watts / 1000) * $/kWh * Solving_Time_hr
            const C_tank_power = (E_tank_w / 1000) * p_electricity_kwh * t_solving_hr;
            const C_postprocess_build_plate = C_solvent + C_tank_power + p_finishing_materials;

            // --- 3. Calculate Totals (Eq 7, expanded) ---

            // C_subtotal_build_plate = Sum of all base costs
            const C_subtotal_build_plate = C_material_build_plate + C_labor_build_plate + C_machine_build_plate + C_tooling_build_plate + C_postprocess_build_plate;

            // C_failure_markup = Cost to account for failures
            const C_failure_markup = (failure_rate &gt; 0 &amp;&amp; failure_rate &lt; 1) ?
                (C_subtotal_build_plate / (1 - failure_rate)) - C_subtotal_build_plate : 0;

            // C_total_build_plate = Base cost + Failure markup
            const C_total_build_plate = C_subtotal_build_plate + C_failure_markup;

            // C_total_per_part = Total build plate cost / number of parts
            const C_total_per_part = (N_parts &gt; 0) ? (C_total_build_plate / N_parts) : 0;

            // C_markup_per_part = Markup % applied to cost per part
            const C_markup_per_part = C_total_per_part * markup_percent;

            // C_final_quote = Final price to charge customer
            const C_final_quote = C_total_per_part + C_markup_per_part;

            // --- 4. Calculate Quick Metrics ---
            const total_mass_g = m_model_g + m_support_g;
            const C_per_hour = (t_program &gt; 0) ? (C_total_build_plate / t_program) : 0;
            const C_per_gram = (total_mass_g &gt; 0) ? (C_total_build_plate / total_mass_g) : 0;

            // --- 5. Store values for Quote Modal ---
            lastCalculatedCosts = {
                C_final_quote, C_total_per_part, C_markup_per_part,
                C_total_build_plate, C_material_build_plate, C_labor_build_plate,
                C_machine_build_plate, C_tooling_build_plate, C_postprocess_build_plate,
                C_subtotal_build_plate, C_failure_markup,
                N_parts, t_program, total_mass_g, C_per_hour, C_per_gram
            };

            // --- 6. Update UI ---

            // Main Display
            document.getElementById('summary_final_quote').textContent = formatCurrency(C_final_quote);
            document.getElementById('summary_total_cost_per_part').textContent = `(${formatCurrency(C_total_per_part)} base cost + ${formatCurrency(C_markup_per_part)} markup)`;

            // Program/Part Summary
            document.getElementById('summary_parts_count_1').textContent = N_parts;
            document.getElementById('summary_total_build_plate_cost').textContent = formatCurrency(C_total_build_plate);
            document.getElementById('summary_base_cost_per_part').textContent = formatCurrency(C_total_per_part);

            // Cost Breakdown
            document.getElementById('summary_material_cost').textContent = formatCurrency(C_material_build_plate);
            document.getElementById('summary_labor_cost').textContent = formatCurrency(C_labor_build_plate);
            document.getElementById('summary_machine_cost').textContent = formatCurrency(C_machine_build_plate);
            document.getElementById('summary_tooling_cost').textContent = formatCurrency(C_tooling_build_plate);
            document.getElementById('summary_post_processing_cost').textContent = formatCurrency(C_postprocess_build_plate);

            document.getElementById('summary_subtotal_cost').textContent = formatCurrency(C_subtotal_build_plate);
            document.getElementById('summary_failure_rate').textContent = formatNum(failure_rate * 100, 0);
            document.getElementById('summary_failure_cost').textContent = formatCurrency(C_failure_markup);
            document.getElementById('summary_total_cost').textContent = formatCurrency(C_total_build_plate);

            // Quick Metrics
            document.getElementById('summary_total_time').textContent = `${formatNum(t_program, 2)} hr`;
            document.getElementById('summary_total_mass').textContent = `${formatNum(total_mass_g, 1)} g`;
            document.getElementById('summary_cost_per_hour').textContent = formatCurrency(C_per_hour);
            document.getElementById('summary_cost_per_gram').textContent = formatCurrency(C_per_gram);

            // Update Pie Chart
            updatePieChart([
                { id: 'legend_material', value: C_material_build_plate, color: '#3b82f6' }, // Blue
                { id: 'legend_labor', value: C_labor_build_plate, color: '#10b981' }, // Green
                { id: 'legend_machine', value: C_machine_build_plate, color: '#f59e0b' }, // Amber
                { id: 'legend_tooling', value: C_tooling_build_plate, color: '#ef4444' }, // Red
                { id: 'legend_finishing', value: C_postprocess_build_plate, color: '#8b5cf6' } // Violet
            ]);
        }

        /**
         * Updates the CSS conic-gradient pie chart and its legend.
         * @param {Array&lt;Object&gt;} costs - Array of cost objects {id, value, color}
         */
        function updatePieChart(costs) {
            const total = costs.reduce((acc, cost) =&gt; acc + cost.value, 0);
            let gradientString = '';
            let currentPercent = 0;

            for (const cost of costs) {
                const percent = (total &gt; 0) ? (cost.value / total) * 100 : 0;
                const percentStr = `(${formatNum(percent, 0)}%)`;

                // Update legend
                const legendEl = document.getElementById(cost.id);
                if (legendEl) {
                    legendEl.textContent = `${formatCurrency(cost.value)} ${percentStr}`;
                }

                // Build gradient string
                if (percent &gt; 0) {
                    const nextPercent = currentPercent + percent;
                    gradientString += `${cost.color} ${currentPercent}% ${nextPercent}%, `;
                    currentPercent = nextPercent;
                }
            }

            // Set chart background
            if (pieChartEl) {
                if (total &gt; 0) {
                    pieChartEl.style.backgroundImage = `conic-gradient(${gradientString.slice(0, -2)})`;
                } else {
                    // Default to gray if no costs
                    pieChartEl.style.backgroundImage = `conic-gradient(#e5e7eb 0% 100%)`;
                }
            }
        }

        // --- PROFILE SAVE/LOAD ---

        // List of all input IDs that are *not* job-specific
        const profileInputIds = [
            'markup_percent', 'printer_cost', 'printer_lifespan_hr', 'maintenance_cost_hr',
            'machine_power_w', 'electricity_cost_kwh',
            'model_material_cost_kg', 'model_material_type', 'model_material_density_custom',
            'support_material_cost_kg', 'support_material_type', 'support_material_density_custom',
            'hourly_wage',
            'prep_slicing_time', 'manual_labor_time', // v2: Added build plate-level labor
            'build_plate_cost', 'build_plate_lifespan_hr',
            'model_nozzle_cost', 'model_nozzle_lifespan_kg',
            'support_nozzle_cost', 'support_nozzle_lifespan_kg',
            'solvent_cost_liter', 'tank_power_w'
            // Note: finishing_labor_time_part and finishing_materials_cost are job-specific
        ];

        function saveProfile() {
            if (!storageAvailable) {
                showMessage('Error: Browser storage is not available or blocked.', 'error');
                return;
            }
            try {
                const profile = {};
                for (const id of profileInputIds) {
                    const el = document.getElementById(id);
                    if (el) {
                        profile[id] = el.value;
                    }
                }
                localStorage.setItem('fdmCalculatorProfile', JSON.stringify(profile));
                showMessage('Printer profile saved successfully!', 'success');
            } catch (error) {
                console.error(&quot;Failed to save profile:&quot;, error);
                showMessage('Error saving profile. Storage may be full or blocked by browser settings.', 'error');
            }
        }

        function loadProfile() {
            if (!storageAvailable) {
                showMessage('Error: Browser storage is not available or blocked.', 'error');
                return;
            }
            try {
                const profileString = localStorage.getItem('fdmCalculatorProfile');
                if (!profileString) {
                    showMessage('No saved profile found.', 'error');
                    return;
                }
                const profile = JSON.parse(profileString);
                for (const id of profileInputIds) {
                    if (profile[id] !== undefined) {
                        const el = document.getElementById(id);
                        if (el) {
                            el.value = profile[id];
                        }
                    }
                }

                // Trigger updates for custom fields and info boxes
                toggleCustomDensity('model_material_type', 'model_material_density_custom_wrapper');
                toggleCustomDensity('support_material_type', 'support_material_density_custom_wrapper');
                updateMaterialInfo('model_material_type', 'model_material_info');
                updateMaterialInfo('support_material_type', 'support_material_info');

                // Recalculate
                calculateCost();
                showMessage('Profile loaded successfully!', 'success');
            } catch (error) {
                console.error(&quot;Failed to load profile:&quot;, error);
                showMessage('Error loading profile. Data may be corrupt or blocked by browser settings.', 'error');
            }
        }

        // --- CUSTOM MATERIAL MANAGER ---

        function getCustomMaterials() {
            if (!storageAvailable) return [];
            try {
                const materialsString = localStorage.getItem(CUSTOM_MATERIALS_KEY);
                return materialsString ? JSON.parse(materialsString) : [];
            } catch (e) {
                return [];
            }
        }

        function saveCustomMaterials(materials) {
            if (!storageAvailable) return;
            try {
                localStorage.setItem(CUSTOM_MATERIALS_KEY, JSON.stringify(materials));
            } catch (e) {
                console.error(&quot;Failed to save custom materials:&quot;, e);
                showMessage('Error saving custom material. Storage may be full.', 'error');
            }
        }

        function saveNewCustomMaterial() {
            const name = getStr('custom_material_name');
            const density = getVal('custom_material_density');

            if (!name || density &lt;= 0) {
                showMessage('Please enter a valid material name and density.', 'error');
                return;
            }

            const newMaterial = { name, density };
            const materials = getCustomMaterials();

            // Check for duplicates
            if (materials.some(m =&gt; m.name.toLowerCase() === name.toLowerCase())) {
                showMessage('A material with this name already exists.', 'error');
                return;
            }

            materials.push(newMaterial);
            saveCustomMaterials(materials);
            populateCustomMaterialDropdowns();
            renderCustomMaterialList();

            // Clear inputs
            document.getElementById('custom_material_name').value = '';
            document.getElementById('custom_material_density').value = '';

            showMessage(`Material &quot;${name}&quot; saved!`, 'success');
        }

        function populateCustomMaterialDropdowns() {
            const materials = getCustomMaterials();
            const modelGroup = document.getElementById('model_material_custom_group');
            const supportGroup = document.getElementById('support_material_custom_group');

            if (!modelGroup || !supportGroup) return;

            // Clear existing options
            modelGroup.innerHTML = '';
            supportGroup.innerHTML = '';

            materials.forEach(material =&gt; {
                const value = `${material.density}_${material.name}`;
                const text = `${material.name} (${material.density} g/cm³)`;

                const modelOption = new Option(text, value);
                modelGroup.appendChild(modelOption);

                const supportOption = new Option(text, value);
                supportGroup.appendChild(supportOption);
            });
        }

        function renderCustomMaterialList() {
            const materials = getCustomMaterials();
            const listEl = document.getElementById('custom_material_list');
            if (!listEl) return;

            if (materials.length === 0) {
                listEl.innerHTML = '&lt;p&gt;No custom materials saved.&lt;/p&gt;';
                return;
            }

            listEl.innerHTML = '&lt;strong class=&quot;block mb-1&quot;&gt;Saved Materials:&lt;/strong&gt;';
            materials.forEach((material, index) =&gt; {
                const el = document.createElement('div');
                el.className = 'flex justify-between items-center bg-gray-50 p-2 rounded';
                el.innerHTML = `
                    &lt;span&gt;${material.name} (${material.density} g/cm³)&lt;/span&gt;
                    &lt;button data-index=&quot;${index}&quot; class=&quot;remove-material-btn text-red-500 hover:text-red-700 text-xs font-medium&quot;&gt;Remove&lt;/button&gt;
                `;
                listEl.appendChild(el);
            });
        }

        function removeCustomMaterial(e) {
            if (!e.target.classList.contains('remove-material-btn')) return;

            const index = parseInt(e.target.getAttribute('data-index'), 10);
            let materials = getCustomMaterials();
            const removed = materials.splice(index, 1);
            saveCustomMaterials(materials);
            populateCustomMaterialDropdowns();
            renderCustomMaterialList();

            if (removed.length &gt; 0) {
                showMessage(`Material &quot;${removed[0].name}&quot; removed.`, 'success');
            }
        }

        // --- QUOTE MODAL ---

        function openQuoteModal() {
            // Populate modal with data from last calculation
            const customer = getStr('quote_customer') || &quot;N/A&quot;;
            const partName = getStr('quote_part_name') || &quot;N/A&quot;;
            const materialName = getMaterialName('model_material_type');

            document.getElementById('quote_date').textContent = new Date().toLocaleDateString();
            document.getElementById('quote_customer_name').textContent = customer;
            document.getElementById('quote_part_name_val').textContent = partName;
            document.getElementById('quote_material_val').textContent = materialName;
            document.getElementById('quote_time_val').textContent = `${formatNum(lastCalculatedCosts.t_program, 2)} hr`;

            document.getElementById('quote_item_name').textContent = partName;
            document.getElementById('quote_quantity_val').textContent = lastCalculatedCosts.N_parts;
            document.getElementById('quote_price_per_val').textContent = formatCurrency(lastCalculatedCosts.C_final_quote);

            const total = lastCalculatedCosts.C_final_quote * lastCalculatedCosts.N_parts;
            document.getElementById('quote_total_val').textContent = formatCurrency(total);
            document.getElementById('quote_grand_total_val').textContent = formatCurrency(total);

            if (quoteModal) quoteModal.classList.remove('hidden');
        }

        function closeQuoteModal() {
            if (quoteModal) quoteModal.classList.add('hidden');
        }

        function printQuote() {
            // Store notes value so it persists after print dialog
            const notes = document.getElementById('quote_notes_input');
            if (notes) notes.dataset.value = notes.value;

            window.print();

            // Restore value after print
            if (notes &amp;&amp; notes.dataset.value) {
                notes.value = notes.dataset.value;
            }
        }


        // --- EVENT LISTENERS ---

        // Add 'input' event listener to all inputs to recalculate
        allInputs.forEach(input =&gt; {
            input.addEventListener('input', calculateCost);
        });

        // Add listeners for custom density toggles
        document.getElementById('model_material_type').addEventListener('input', () =&gt; {
            toggleCustomDensity('model_material_type', 'model_material_density_custom_wrapper');
            updateMaterialInfo('model_material_type', 'model_material_info');
        });
        document.getElementById('support_material_type').addEventListener('input', () =&gt; {
            toggleCustomDensity('support_material_type', 'support_material_density_custom_wrapper');
            updateMaterialInfo('support_material_type', 'support_material_info');
        });

        // Add listeners for Save/Load buttons
        if (saveProfileButton) saveProfileButton.addEventListener('click', saveProfile);
        if (loadProfileButton) loadProfileButton.addEventListener('click', loadProfile);

        // Custom Material Listeners
        if (saveMaterialButton) saveMaterialButton.addEventListener('click', saveNewCustomMaterial);
        const materialListEl = document.getElementById('custom_material_list');
        if (materialListEl) materialListEl.addEventListener('click', removeCustomMaterial);

        // Quote Modal Listeners
        if (generateQuoteBtn) generateQuoteBtn.addEventListener('click', openQuoteModal);
        if (quoteModalCloseBtn) quoteModalCloseBtn.addEventListener('click', closeQuoteModal);
        if (quoteModalBackdrop) quoteModalBackdrop.addEventListener('click', closeQuoteModal);
        if (printQuoteBtn) printQuoteBtn.addEventListener('click', printQuote);

        // --- INITIALIZATION ---

        // Load custom materials into dropdowns
        populateCustomMaterialDropdowns();
        renderCustomMaterialList();

        // Run initial calculation on page load
        calculateCost();

        // Set initial state for info boxes
        updateMaterialInfo('model_material_type', 'model_material_info');
        updateMaterialInfo('support_material_type', 'support_material_info');

    }); // Close DOMContentLoaded
&lt;/script&gt;
</code></pre>
</body>
</html>

      </main>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="YouTube" aria-label="YouTube">
    <a target="_blank" rel="noopener" href="https://www.youtube.com/channel/UCM_8Mv-0S1LnnJpRJLjahaw?sub_confirmation=1" aria-label="YouTube">
      <i class="fa fa-youtube"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Twitter" aria-label="Twitter">
    <a target="_blank" rel="noopener" href="https://twitter.com/Michael24919360" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Facebook" aria-label="Facebook">
    <a target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100089187391163" aria-label="Facebook">
      <i class="fab facebook"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/google/docsy" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Minimal 3DP Github" aria-label="Minimal 3DP Github">
    <a target="_blank" rel="noopener" href="https://github.com/minimal3dp/minimal3dp.github.io" aria-label="Minimal 3DP Github">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Developer mailing list" aria-label="Developer mailing list">
    <a target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Developer mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2021&ndash;2025
    <span class="td-footer__authors">Mike Wilson and Minimal 3DP | <a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a> |</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.js"></script>
<script defer src="/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>